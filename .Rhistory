rankDFS=(1+77)/2
rankRE=(78+77+35)/2
rankDead=(77+35+1+77+35+66)/2
rankDFS
rankRE
rankDead
Tb=46*rankDFS+18*rankRE+23*rankDead
ETb=87*179/2
VarTb=91*87/177*(1/178*(77*rankDFS^2+ 35*rankRE^2  +66*rankDead^2)-179^2/4)
rankDFS=(1+77)/2
rankRE=(78+77+35)/2
rankDead=(77+35+1+77+35+66)/2
rankDFS
rankRE
rankDead
Tb=46*rankDFS+18*rankRE+23*rankDead
ETb=87*179/2
VarTb=91*87/177*(1/178*(77*rankDFS^2+ 35*rankRE^2  +66*rankDead^2)-179^2/4)
Test.statistics=(Tb-ETb)^2/VarTb
rankDFS=(1+77)/2
rankRE=(78+77+35)/2
rankDead=(77+35+1+77+35+66)/2
rankDFS
rankRE
rankDead
Tb=46*rankDFS+18*rankRE+23*rankDead
ETb=87*179/2
VarTb=91*87/177*(1/178*(77*rankDFS^2+ 35*rankRE^2  +66*rankDead^2)-179^2/4)
Test.statistics=(Tb-ETb)^2/VarTb
pchisq(Test.statistics,1,lower.tail = FALSE)
Tb, ETb,VarTb,Test.statistics
Tb
ETb
VarTb
Test.statistics
pchisq(0.017,1,lower.tail = FALSE)
pchisq(0.017,1,lower.tail = FALSE)
pchisq(0.017,2,lower.tail = FALSE)
Exper=c(1:16)
#sum(Exper^2)
64/15*(1496/16-17*17/4)
21^2/90.66667
pchisq(21^2/90.66667,1,lower.tail = FALSE)
64*(17)/12
sampledata <- read.csv(file = 'train_sample.csv')
head(sampledata)
knit_with_parameters("~/Documents/GitHub/STAT605_Project/proposal.Rmd")
rm(list=ls())
mydata <- read.table("train_sample.csv", header=TRUE,
sep=",", row.names="id")
mydata <- read.csv("train_sample.csv", header=TRUE,
sep=",", row.names="id")
mydata <- read.csv('train_sample.csv')
#rm(list=ls())
mydata <- read.csv('train_sample.csv')
#rm(list=ls())
mydata <- read.csv('train_sample.csv')
#rm(list=ls())
setwd("/Users/wanxintu/Documents/GitHub")
mydata <- read.csv('train_sample.csv')
#rm(list=ls())
setwd("/Users/wanxintu/Documents/GitHub/STAT605_Project")
mydata <- read.csv('train_sample.csv')
View(mydata)
#rm(list=ls())
dir=getwd()
setwd(dir)
#setwd("/Users/wanxintu/Documents/GitHub/STAT605_Project")
mydata <- read.csv('train_sample.csv')
#imbanlance
##
head(mydata)
table(mydata$is_attributed)
prop.table(table(df$Class))
prop.table(table(mydata$Class))
prop.table(table(mydata$Class))
prop.table(table(mydata$is_attributed))
#imbanlance
##
head(mydata)
library(ggplot2)
#
p1=ggplot(mydata,aes(x=is_attributed,y=app,fill=is_attributed))+
geom_boxplot()+
ggtitle("Application ID v/s Is_attributed")+
xlab("App ID") +
labs(fill = "is_attributed")
p2=ggplot(mydata,aes(x=app,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("Application ID v/s Is_attributed")+
xlab("App ID") +
labs(fill = "is_attributed")
p3=ggplot(mydata,aes(x=is_attributed,y=app,fill=is_attributed))+
geom_violin()+
ggtitle("Application ID v/s Is_attributed")+
xlab("App ID") +
labs(fill = "is_attributed")
grid.arrange(p1,p2, p3, nrow=2,ncol=2)
p1
#
p1=ggplot(data=mydata,aes(x=is_attributed,y=app,fill=is_attributed))+
geom_boxplot()+
ggtitle("Application ID v/s Is_attributed")+
xlab("App ID") +
labs(fill = "is_attributed")
p1
p2=ggplot(mydata,aes(x=app,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("Application ID v/s Is_attributed")+
xlab("App ID") +
labs(fill = "is_attributed")
p2
p1
p2
####App was downloaded v/s App id for marketing
p2=ggplot(mydata,aes(x=app,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("Application ID v/s Is_attributed")+
xlab("App ID") +
labs(fill = "is_attributed")
p2
###App was downloaded vs OS version id of user mobile phone
p4=ggplot(train,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_boxplot()+
ggtitle("Os version v/s Is_attributed")+
xlab("OS version") +
labs(fill = "is_attributed")
p5=ggplot(train,aes(x=os,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("Os version v/s Is_attributed ")+
xlab("Os version") +
labs(fill = "is_attributed")
###App was downloaded vs OS version id of user mobile phone
p4=ggplot(train,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_boxplot()+
ggtitle("Os version v/s Is_attributed")+
xlab("OS version") +
labs(fill = "is_attributed")
p5=ggplot(train,aes(x=os,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("Os version v/s Is_attributed ")+
xlab("Os version") +
labs(fill = "is_attributed")
p6=ggplot(train,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_violin()+
ggtitle("Os version v/s Is_attributed")+
xlab("Os version") +
labs(fill = "is_attributed")
grid.arrange(p4,p5, p6, nrow=2,ncol=2)
p4
###App was downloaded vs OS version id of user mobile phone
p4=ggplot(train,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_boxplot()+
ggtitle("Os version v/s Is_attributed")+
xlab("OS version") +
labs(fill = "is_attributed")
p4
###App was downloaded vs OS version id of user mobile phone
p4=ggplot(train,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_boxplot()+
ggtitle("Os version v/s Is_attributed")+
xlab("OS version") +
labs(fill = "is_attributed")
###App was downloaded vs OS version id of user mobile phone
p4=ggplot(mydata,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_boxplot()+
ggtitle("Os version v/s Is_attributed")+
xlab("OS version") +
labs(fill = "is_attributed")
p4
p5=ggplot(mydata,aes(x=os,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("Os version v/s Is_attributed ")+
xlab("Os version") +
labs(fill = "is_attributed")
p5
p6=ggplot(mydata,aes(x=is_attributed,y=os,fill=is_attributed))+
geom_violin()+
ggtitle("Os version v/s Is_attributed")+
xlab("Os version") +
labs(fill = "is_attributed")
p6
###App was downloaded v/s ip address of click.
p8=ggplot(mydata,aes(x=ip,fill=is_attributed))+
geom_density()+facet_grid(is_attributed~.)+
scale_x_continuous(breaks = c(0,50,100,200,300,400))+
ggtitle("IP Address v/s Is_attributed")+
xlab("Ip Adresss of click") +
labs(fill = "is_attributed")
p8
#data banlancing
##smote method
set.seed(1234)
smote_data = SMOTE(is_attributed ~ ., data  = mydata)
smote_data = SMOTE(is_attributed ~ ., data  = mydata)
library(DMwR)#SMOTE Balancing
install.packages("DMeR")
library(DMwR)#SMOTE Balancing
install.packages("DMwR")
install.packages("DMwR2")
library(DMwR2)#SMOTE Balancing
smote_data = SMOTE(is_attributed ~ ., data  = mydata)
library(DMwR)#SMOTE Balancing
library(DMwR2)#SMOTE Balancing
smote_data = SMOTE(is_attributed ~ ., data  = mydata)
install.packages("smotefamily")
library(smotefamily)#SMOTE Balancing
smote_data = SMOTE(is_attributed ~ ., data  = mydata)
smote_data = smote(is_attributed ~ ., data  = mydata)
smote_data = smote(is_attributed ~ ., data  = mydata)
#data banlancing
barplot(prop.table(table(mydata$is_attributed)),
col = rainbow(2),
ylim = c(0, 0.7),
main = "Class Distribution")
#data banlancing
barplot(prop.table(table(mydata$is_attributed)),
col = rainbow(2),
ylim = c(0, 1),
main = "Class Distribution")
#data banlancing
barplot(prop.table(table(mydata$is_attributed)),
col = rainbow(2),
ylim = c(0, 1),
main = "is_attribute Distribution")
##over sampling
over <- ovun.sample(is_attributed~., data = mydata, method = "over", N =1000)$data
library(ROSE)
install.packages("ROSE")
library(randomForest)
install.packages("randomForest")
install.packages("caret")
install.packages("caret")
install.packages("caret")
install.packages("caret")
library(ROSE)
library(randomForest)
library(caret)
library(e1071)
library(ggplot2)
library(ROSE)
library(randomForest)
library(caret)
library(e1071)
##over sampling
over <- ovun.sample(is_attributed~., data = mydata, method = "over", N =1000)$data
##over sampling
over <- ovun.sample(is_attributed~., data = mydata, method = "over")$data
table(over$is_attributed)
knitr::opts_chunk$set(echo = TRUE)
cB58 = data.frame(scale(readFrameFromFITS("cB58_Lyman_break.fit")))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
require("FITSio")
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
cB58 = data.frame(scale(readFrameFromFITS("cB58_Lyman_break.fit")))
rm(list=ls())
require("FITSio")
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
require("FITSio")
library(tidyverse)
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
require("FITSio")
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
require("FITSio")
library(tidyverse)
cB58 = data.frame(scale(readFrameFromFITS("cB58_Lyman_break.fit")))
cB58 = data.frame(scale(readFrameFromFITS("cB58_Lyman_break.fit")))
top10 = read.csv("hw4best100.csv",header=FALSE)[0:10,][2:4]
name<-c("distance","spectrumID","i")
names(top10)<-name
top10
knitr::opts_chunk$set(echo = TRUE)
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
#top1
data=top10[1,]
min_10<-"spec-6489-56329-0866.fits"
file <- readFrameFromFITS(paste("6489",min_10,sep="/"))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
require("FITSio")
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
require("FITSio")
#library(tidyverse)
data=top10[8,]
cB58 = data.frame(scale(readFrameFromFITS("cB58_Lyman_break.fit")))
top10 = read.csv("hw4best100.csv",header=FALSE)[0:10,][2:4]
name<-c("distance","spectrumID","i")
names(top10)<-name
top10
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(500, 10, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top10
data=top10[10,]
min_10<-"spec-6713-56402-0294.fits"
file <- readFrameFromFITS(paste("6713",min_10,sep="/"))
#top10
data=top10[10,]
min_10<-"spec-6713-56402-0294.fits"
file <- readFrameFromFITS(paste("6713",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -3, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(500, 10, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(500, 10, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top1
data=top10[1,]
min_10<-"spec-6489-56329-0866.fits"
file <- readFrameFromFITS(paste("6489",min_10,sep="/"))
#top9
data=top10[9,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
#top8
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -4, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top7
data=top10[7,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
#top3
data=top10[3,]
min_10<-"spec-4058-55358-0100.fits"
file <- readFrameFromFITS(paste("4058",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, 3, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top2
data=top10[2,]
min_10<-"spec-3804-55267-0936.fits"
file <- readFrameFromFITS(paste("3804",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -4, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top3
data=top10[3,]
min_10<-"spec-4058-55358-0100.fits"
file <- readFrameFromFITS(paste("4058",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, 3, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top4
data=top10[4,]
min_10<-"spec-4690-55653-0140.fits"
file <- readFrameFromFITS(paste("4690",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(0, 2.5, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top5
data=top10[5,]
min_10<-"spec-5302-55896-0513.fits"
file <- readFrameFromFITS(paste("5302",min_10,sep="/"))
#top6
data=top10[6,]
min_10<-"spec-5436-56015-0440.fits"
file <- readFrameFromFITS(paste("5436",min_10,sep="/"))
#top5
data=top10[5,]
min_10<-"spec-5302-55896-0513.fits"
file <- readFrameFromFITS(paste("5302",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -2.5, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top7
data=top10[7,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
#top9
data=top10[9,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
#top6
data=top10[6,]
min_10<-"spec-5436-56015-0440.fits"
file <- readFrameFromFITS(paste("5436",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, 3, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top7
data=top10[7,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
#top7
data=top10[7,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, 2.5, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top8
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -4, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top9
data=top10[9,]
min_10<-"spec-6052-56092-0294.fits"
file <- readFrameFromFITS(paste("6052",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -2, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top10
data=top10[10,]
min_10<-"spec-6713-56402-0294.fits"
file <- readFrameFromFITS(paste("6713",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, -3, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
data=top10[8,]
min_10<-"spec-6303-56539-0090.fits"
file <- readFrameFromFITS(paste("6303",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(500, 10, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
#top1
data=top10[1,]
min_10<-"spec-6489-56329-0866.fits"
file <- readFrameFromFITS(paste("6489",min_10,sep="/"))
file = data.frame(scale(file[data$i:(data$i+2180),]))
plot(x=seq(1:2181),y=file$flux,col="red",type="l",xlab="Length",ylab="flux");
##cB 58
lines(x=seq(1:2181),y=cB58$FLUX)
legend(1000, 2, legend=c(min_10, "cB58_Lyman_break.fit"),
col=c("red","black"), lty=1:2, cex=0.6)
